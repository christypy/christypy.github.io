<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ä¸€å‘³æ·¨ç”Ÿæ´»å’–å•¡ç³»çµ±</title>
<style>
    /* å…¨å±€è®Šæ•¸èˆ‡é…è‰²å„ªåŒ– */
    :root {
        --color-primary: #5c3a21; 
        --color-secondary: #9a6e4e; 
        --color-accent: #e2b34a; 
        --color-background: #fdf6e9; 
        --color-light-gray: #e6e0d8; 
        --color-done-bg: #f5f0e7; 
        --color-success: #4a7d4a; 
        --color-danger: #cf4a4a; 
        --color-total-progress: #d68910; 
        --color-section-bg: #ffffff; 
        --color-text: #333333; 
        --shadow-medium: 0 4px 12px rgba(0,0,0,0.1);
        --border-radius-lg: 15px;
        --border-radius-md: 8px;
    }

    body { 
        font-family: 'Noto Sans TC', -apple-system, sans-serif; 
        background: var(--color-background); 
        padding: 0 10px 40px 10px; 
        color: var(--color-text); 
        max-width: 800px; 
        margin: 0 auto;
        line-height: 1.5;
    }

    h2 { text-align: center; color: var(--color-primary); margin: 20px 0; font-size: 26px; }

    /* åˆ†é¡å€å¡Šç¾åŒ– */
    .section-card {
        background: var(--color-section-bg);
        border-radius: var(--border-radius-lg);
        box-shadow: var(--shadow-medium);
        margin-bottom: 25px;
        overflow: hidden;
        border: 1px solid var(--color-light-gray);
    }
    .section-header {
        background: var(--color-secondary);
        color: white;
        padding: 12px 18px;
        font-weight: bold;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    /* é ‚éƒ¨æŒ‰éˆ• */
    .nav-header { display: flex; gap: 10px; margin-bottom: 15px; }
    .nav-btn {
        flex: 1; padding: 12px; border-radius: 50px; text-decoration: none;
        text-align: center; font-weight: bold; background: #607d8b; color: white;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1); font-size: 14px;
    }

    /* æ§åˆ¶é … */
    .controls { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
    select { flex: 2; padding: 12px; border-radius: var(--border-radius-md); border: 1px solid #ccc; font-size: 16px; min-width: 150px; }
    .btn-main { flex: 1; padding: 12px; border-radius: var(--border-radius-md); border: none; background: var(--color-accent); font-weight: bold; cursor: pointer; }
    .btn-reset { background: #bbb; color: white; }

    /* çµ±è¨ˆå€ */
    .stat-grid { display: grid; grid-template-columns: 1fr; gap: 20px; }
    @media (min-width: 600px) { .stat-grid { grid-template-columns: 1fr 1fr; } }
    .stat-item-row { display: flex; justify-content: space-between; padding: 8px 10px; font-weight: bold; cursor: pointer; }
    .progress-bar { height: 6px; background: #eee; border-radius: 3px; margin: 0 10px 10px 10px; overflow: hidden; }
    .progress-inner { height: 100%; transition: width 0.3s; }

    /* è¨‚å–®æ˜ç´° */
    .order-detail { padding: 5px 10px; border-bottom: 1px solid #f0f0f0; display: flex; align-items: center; gap: 10px; }
    .order-detail.done { background: #f9f9f9; opacity: 0.6; text-decoration: line-through; }
    .order-detail.absent { background: #ffebee; opacity: 0.5; }
    .customer-box { flex: 1; display: flex; flex-direction: column; cursor: pointer; }
    .tag { font-size: 11px; background: var(--color-accent); padding: 2px 5px; border-radius: 4px; margin-left: 5px; color: var(--color-primary); }
    .btn-absent { font-size: 12px; padding: 4px 8px; border-radius: 4px; border: 1px solid #ddd; background: #fff; color: var(--color-danger); cursor: pointer; }

    /* åƒ¹æ ¼è¡¨èˆ‡è±†å–® */
    .price-table { width: 100%; border-collapse: collapse; font-size: 14px; }
    .price-table th { background: #f4f4f4; padding: 10px; text-align: center; }
    .price-table td { padding: 10px; text-align: center; border-bottom: 1px solid #eee; }
    .price-val { color: var(--color-danger); font-weight: bold; }
    .price-val::before { content: '$'; }

    /* åšæ³•æç¤ºå€ */
    .recipe-box { padding: 15px; font-size: 14px; line-height: 1.8; color: #444; }
    .recipe-title { color: var(--color-primary); font-weight: bold; border-left: 4px solid var(--color-accent); padding-left: 8px; margin-bottom: 5px; }

    @media (max-width: 500px) {
        .price-table { font-size: 12px; }
        .price-table th, .price-table td { padding: 8px 2px; }
    }
</style>
</head>
<body>

<div class="nav-header">
    <a href="https://christypy.github.io/time" class="nav-btn">â±ï¸ è¨ˆæ™‚å™¨</a>
    <a href="https://christypy.github.io/record" class="nav-btn">ğŸ“ è¨˜éŒ„å™¨</a>
</div>

<h2>â˜• ä¸€å‘³æ·¨ç”Ÿæ´»å’–å•¡å‚™é¤ç³»çµ±</h2>

<div class="controls">
    <select id="daySelect" onchange="renderOrders()">
        <option value="1">æ˜ŸæœŸä¸€ (å¸‚å ´ä¼‘)</option>
        <option value="2">æ˜ŸæœŸäºŒ</option>
        <option value="3">æ˜ŸæœŸä¸‰</option>
        <option value="4">æ˜ŸæœŸå››</option>
        <option value="5">æ˜ŸæœŸäº”</option>
        <option value="6">æ˜ŸæœŸå…­</option>
        <option value="0">æ˜ŸæœŸæ—¥</option>
    </select>
    <button class="btn-main" onclick="renderOrders()">åˆ·æ–°åˆ—è¡¨</button>
    <button class="btn-main btn-reset" onclick="clearAll()">å…¨éƒ¨é‡ç½®</button>
</div>

<div class="stat-grid">
    <div class="section-card">
        <div class="section-header" style="background:#4a7d4a">ğŸ  å·¦å³é„°å±…</div>
        <div id="stats-neighbor"></div>
    </div>
    <div class="section-card">
        <div class="section-header" style="background:#d68910">ğŸ›µ å…¶ä»–å€åŸŸ</div>
        <div id="stats-other"></div>
    </div>
</div>

<div class="section-card">
    <div class="section-header">ğŸ’° é£²å“èˆ‡å–®å“åƒ¹æ ¼è¡¨</div>
    <table class="price-table">
        <thead>
            <tr><th>å“é …</th><th>å¤–å¸¶</th><th>å…§ç”¨</th><th>åŠç£…</th><th>æ¿¾æ›</th></tr>
        </thead>
        <tbody>
            <tr><td><b>è¦º</b></td><td class="price-val">200</td><td class="price-val">250</td><td class="price-val">950</td><td>-</td></tr>
            <tr><td><b>èŠ±/å¯¶</b></td><td class="price-val">180</td><td class="price-val">230</td><td class="price-val">850</td><td class="price-val">55</td></tr>
            <tr><td><b>è©/é›…/éœ/æœ</b></td><td class="price-val">130</td><td class="price-val">180</td><td class="price-val">600~700</td><td class="price-val">45</td></tr>
            <tr><td><b>ç¦/æŸ”</b></td><td class="price-val">130</td><td class="price-val">180</td><td class="price-val">450~550</td><td class="price-val">35</td></tr>
            <tr style="background:#fdf6e9"><td colspan="5"><b>ç¾©å¼ï¼š</b>ç¾å¼ 70/75 | æ‹¿éµ 85 | å¤§ç¾ 80 | å¤§æ‹¿ 95 | æ­è•¾(æŠ¹èŒ¶/å·§) 85</td></tr>
        </tbody>
    </table>
</div>

<div class="section-card">
    <div class="section-header" style="background:#6d4c41">ğŸ“– èª¿è£½é…æ–¹å‚™å¿˜</div>
    <div class="recipe-box">
        <div class="recipe-title">â˜• åŸºç¤æ¯”ä¾‹</div>
        20g ç²‰ â” èƒå– 40g æ¿ƒç¸® (30-45s)ã€‚<br>
        <div class="recipe-title">ğŸµ æŠ¹èŒ¶/å·§å…‹åŠ›æ­è•¾</div>
        ç²‰ 7g + ç³–ç²‰ 6g + ç†±æ°´ 40-60g æ”ªå‹» â” ç†±ç‰›å¥¶è£œæ»¿ã€‚
    </div>
</div>

<script>
    const customers = [
        { loc: "å³é„°", name: "æ€¡é¦™è»’", item: "ç†±ç¾å¼", type: "hot_am", days: [], groupId: "n1" },
        { loc: "å³é„°", name: "æ²¹é£¯", item: "ç†±ç¾å¼", tag: "ç•¶æ—¥å•", type: "hot_am", days: [], groupId: "n2" },
        { loc: "å³é„°", name: "å±±åŸç±³é£Ÿ", item: "ç†±æ‹¿éµ", note: "å¯„æ¯", type: "hot_latte", days: [], groupId: "n3" },
        { loc: "å³é„°", name: "æ©˜å­æ”¤", item: "ç†±æ‹¿éµ", type: "hot_latte", days: [], groupId: "n4" },
        { loc: "å³é„°", name: "ç³–æœ", item: "ç†±æ‹¿éµ", note: "ä»˜å…©å¤©", type: "hot_latte", days: [6, 0], groupId: "n5" },
        { loc: "å·¦é„°", name: "ç‰›è‚‰", item: "ç†±æ‹¿éµ", tag: "åŠ 3gç³–", type: "hot_latte_sugar", days: [3, 5, 0], groupId: "n6" },
        { loc: "å·¦é„°", name: "å¸ƒè€é—†", item: "ç†±ç¾å¼", note: "å¯„æ¯", type: "hot_am", days: [5], groupId: "n7" },
        { loc: "å·¦é„°", name: "ç”˜è”—é›", item: "ç¾å¼(å†¬ç†±å¤å†°)", type: "hot_am", days: [], groupId: "n8" },
        { loc: "å·¦é„°", name: "å®œè˜­é­šæ”¤", item: "å†°ç¾+å†°æ‹¿", tag: "åŠ ç³–", type: "ice_latte_sugar", days: [6], count: 2, groupId: "n9" },
        { loc: "å€åŸŸ", name: "è³£é­šå“¡å·¥", item: "å¤§ç†±ç¾", tag: "ä»˜å…©å¤©", type: "large_hot_am", days: [6, 0], groupId: "o1" },
        { loc: "å€åŸŸ", name: "ç‰›è‚‰çˆ¸çˆ¸", item: "å¤§æ‹¿éµ", tag: "ç²‰20g", type: "large_hot_latte", days: [], groupId: "o2" },
        { loc: "å€åŸŸ", name: "é­šè€é—†", item: "å¤§æ‹¿éµ", note: "å¯„æ¯", type: "large_hot_latte", days: [2, 3, 5], groupId: "o3" },
        { loc: "å€åŸŸ", name: "æ°´æœæ”¤(é­šéš”å£)", item: "ç†±æ‹¿éµ", type: "hot_latte", days: [2, 3, 6, 0], groupId: "o4" },
        { loc: "å€åŸŸ", name: "è¦è€é—†", item: "ç†±ç¾å¼", type: "hot_am", days: [2, 4, 5, 6, 0], groupId: "o5" },
        { loc: "å€åŸŸ", name: "èœœè˜‹æœ", item: "ç†±æ‹¿éµ", tag: "ç•¶æ—¥å•", type: "hot_latte", days: [4, 5], groupId: "o6" },
        { loc: "å€åŸŸ", name: "éµé‹è¡Œ", item: "å†°ç¾å¼", type: "ice_am", days: [5], count: 2, groupId: "o7" },
        { loc: "å€åŸŸ", name: "ç™½é«®èœè€é—†", item: "å†°æ‰‹æ²–", tag: "é›…$100", type: "hand_drip", days: [4], groupId: "o8" },
        { loc: "å€åŸŸ", name: "æŠ“é¤…å¥³è€é—†", item: "ç†±ç¾å¼", tag: "ç•¶æ—¥å•", type: "hot_am", days: [2, 4], groupId: "o9" },
        { loc: "å€åŸŸ", name: "è±åŸç´ é£Ÿ", item: "ç†±ç¾å¼", type: "hot_am", days: [3], groupId: "o10" },
        { loc: "å€åŸŸ", name: "åœ‹è¯å“¥åª½åª½", item: "ç†±ç¾å¼", type: "hot_am", days: [2, 5], groupId: "o11" },
        { loc: "å€åŸŸ", name: "è±†è…è€é—†", item: "å†°ç¾å¼", tag: "ç•¶æ—¥å•", type: "ice_am", days: [6], groupId: "o12" }
    ];

    const types = { hot_am: "â˜• ç†±ç¾å¼", ice_am: "ğŸ§Š å†°ç¾å¼", hot_latte: "ğŸ”¥ ç†±æ‹¿éµ", hot_latte_sugar: "ğŸ¬ ç†±æ‹¿(ç³–)", ice_latte_sugar: "ğŸ­ å†°æ‹¿(ç³–)", large_hot_am: "ğŸ¥¤ å¤§ç†±ç¾", large_hot_latte: "ğŸ¥¤ å¤§ç†±æ‹¿", hand_drip: "ğŸ’§ æ‰‹æ²–" };

    const getDayKey = () => new Date().toISOString().slice(0, 10);

    function renderOrders() {
        const day = parseInt(document.getElementById('daySelect').value);
        const sN = document.getElementById('stats-neighbor'), sO = document.getElementById('stats-other');
        if (day === 1) { sN.innerHTML = sO.innerHTML = '<p style="padding:20px;text-align:center">æœ¬æ—¥ä¼‘æ¯</p>'; return; }

        let dataN = {}, dataO = {};
        Object.keys(types).forEach(k => { dataN[k] = { total: 0, done: 0, list: [] }; dataO[k] = { total: 0, done: 0, list: [] }; });

        customers.filter(c => c.days.length === 0 || c.days.includes(day)).forEach(c => {
            let target = c.loc.includes("é„°") ? dataN : dataO;
            let isAbs = localStorage.getItem(`abs_${getDayKey()}_${c.groupId}`);
            let cnt = c.count || 1;
            if (!isAbs) target[c.type].total += cnt;
            for(let i=0; i<cnt; i++) {
                let isDone = localStorage.getItem(`done_${getDayKey()}_${c.groupId}_${i}`);
                if (isDone && !isAbs) target[c.type].done++;
                target[c.type].list.push({ ...c, isDone, isAbs, idx: i });
            }
        });

        const build = (obj) => {
            let h = '';
            Object.keys(obj).forEach(k => {
                if (obj[k].list.length === 0) return;
                let s = obj[k], per = (s.done/s.total)*100 || 0;
                h += `<div class="stat-item-row"><span>${types[k]}</span><span>${s.done}/${s.total}</span></div>
                      <div class="progress-bar"><div class="progress-inner" style="width:${per}%;background:${per===100?'#4a7d4a':'#e2b34a'}"></div></div>`;
                s.list.forEach(o => {
                    h += `<div class="order-detail ${o.isDone?'done':''} ${o.isAbs?'absent':''}">
                            <button class="btn-absent" onclick="toggleAbs('${o.groupId}')">${o.isAbs?'æ¢å¾©':'ç¼ºå¸­'}</button>
                            <div class="customer-box" onclick="toggleDone('${o.groupId}', ${o.idx})">
                                <span><b>${o.name}</b> ${o.tag||o.note?`<span class="tag">${o.tag||o.note}</span>`:''}</span>
                                <small style="color:#666">${o.item}</small>
                            </div>
                            <input type="checkbox" ${o.isDone||o.isAbs?'checked':''} ${o.isAbs?'disabled':''}>
                          </div>`;
                });
            });
            return h || '<p style="padding:10px">ç„¡è¨‚å–®</p>';
        };
        sN.innerHTML = build(dataN); sO.innerHTML = build(dataO);
    }

    window.toggleDone = (id, idx) => {
        let key = `done_${getDayKey()}_${id}_${idx}`;
        localStorage.getItem(key) ? localStorage.removeItem(key) : localStorage.setItem(key, '1');
        renderOrders();
    };

    window.toggleAbs = (id) => {
        let key = `abs_${getDayKey()}_${id}`;
        localStorage.getItem(key) ? localStorage.removeItem(key) : localStorage.setItem(key, '1');
        renderOrders();
    };

    window.clearAll = () => { if(confirm("é‡ç½®ä»Šæ—¥æ‰€æœ‰ç‹€æ…‹ï¼Ÿ")) { localStorage.clear(); renderOrders(); } };

    document.getElementById('daySelect').value = new Date().getDay();
    renderOrders();
</script>
</body>
</html>
